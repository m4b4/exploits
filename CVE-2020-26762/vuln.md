# The vulnerability
The overflow occurs in ipcam_cgi (bin) due to a missing size check in function doGetSysteminfo() which can be seen in the decompiled code below.

![Screenshot](img/vuln_decompiled.jpg)

FUN_0040c500 is responsible for parsing the GET parameters that are being passed via the endpoint /camera-cgi/public/getsysteminfo.cgi?action=value. `char *param_2` here represents the pointer to the parameters (here: action=value), also known as the url query. Without going into further details, the query string is splitted into (127 0x7f byte) chunks (line: 22), while the chunks are arranged in a 1024 byte buffer on the stack. After the buffer overflows in line 28, `strtok_r` will crash the program in line 21 in case `local_c` is not overwritten properly. The exploit makes `local_c` point to a nullpointer to prevent the program from crashing.
